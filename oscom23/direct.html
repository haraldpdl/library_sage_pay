<h1>Direct <small>v3.0<br />for osCommerce Online Merchant v2.3</small></h1>

<p>Sage Pay Direct is essentially a white-label payment solution giving you complete control over the way you process payments. Collect the card details through your own secure servers and securely pass them across to Sage Pay for authorisation and storage.</p>

<ul>
  <li>Shoppers stay on your site</li>
  <li>Design, manage and host your own payment pages</li>
  <li>Develop your own transaction reporting</li>
  <li>Build your own automated transaction functions</li>
  <li>Fully integrate with your backend systems (ie call centre software, CRM solutions, etc)</li>
  <li>You will need to get your own PCI DSS certification and SSL certificates</li>
</ul>

<p>Sage Pay Direct is bundled with osCommerce Online Merchant and is also available as a separate Add-On package existing store owners can use to upgrade to.</p>

<p>The Sage Pay Direct payment module supports the following features:</p>

<ul>
  <li>Securely stored payment cards (Tokens)</li>
  <li>PayPal payments</li>
  <li>SSL Certificate verified transactions</li>
</ul>

<div class="visible-print">
  <p>This document can be found online at:</p>

  <p><a href="{link}Package|Library|en&sage_pay&oscom23&direct{link}">{link}Package|Library|en&sage_pay&oscom23&direct{link}</a></p>
</div>

<h2>Features</h2>

<h3>Securely Stored Payment Cards (Tokens)</h3>

<p>If stored tokens is enabled, customers are given the opportunity to securely save their card payment information during their purchase and to reference the card in their next purchase without having to re-type their card information again. The card payment information is securely stored at Sage Pay's servers and is referenced with a unique token code.</p>

<div class="info">If stored tokens is enabled, it is important to enable the Sage Pay Cards Management Page content module to allow customers to manage their stored cards in their account area. The content module can be found on the Administration Tool -> Modules -> Content -> Install Module page.</div>

<div class="note">Stored Payment Cards (Tokens) requires support for Content Modules that was introduced in osCommerce Online Merchant v2.3.4.</div>

<h3>PayPal Payments</h3>

<p>PayPal payments can be provided as an option as a card payment method. This requires PayPal to be added as a supported payment method to your Sage Pay account and to link your PayPal seller account to your Sage Pay account.</p>

<h3>SSL Certificate Verified Transactions</h3>

<p>All secured API transaction calls sent to Sage Pay are performed by verifying Sage Pay's SSL certificates to guarantee the identity of Sage Pay. This is performed by using the following public keys in order if they are available:</p>

<ul>
  <li>ext/modules/payment/sage_pay/sagepay.com.crt</li>
  <li>includes/cacert.pem (public key bundle)</li>
  <li>the web server configured public key bundle</li>
</ul>

<p>A test connection link is available on the payment module configuration page which can be used to test if API transaction calls to Sage Pay can be verified from your web server. If the test connection fails, please contact your hosting provider as they may need to update your web server configuration. The SSL certificate verification can also be disabled on the payment module configuration page however it is highly discouraged to disable.</p>

<h2>Configuration Settings</h2>

<table class="pretty">
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Enable Sage Pay Direct Module</td>
      <td>Setting this parameter to <em>True</em> makes the payment method available to customers during the checkout procedure.</td>
      <td><em>True</em></td>
    </tr>
    <tr>
      <td>Vendor Login Name</td>
      <td>The vendor login name used to connect to the transaction gateway with.</td>
      <td></td>
    </tr>
    <tr>
      <td>Verify With CVC</td>
      <td>Setting this parameter to <em>True</em> verifies the billing address with the Credit Card Verification Checknumber (CVC).</td>
      <td><em>True</em></td>
    </tr>
    <tr>
      <td>Create Tokens</td>
      <td>Allows customers to store their payment cards securely at Sage Pay and reference the cards for future payments via tokens.</td>
      <td><em>False</em></td>
    </tr>
    <tr>
      <td>Transaction Method</td>
      <td>
        The following transaction methods are available to process transactions with:

        <dl>
          <dt>Authenticate</dt>
          <dd>The <em>Authenticate</em> transaction method only verifies the card and card holder using the 3D-Secure mechanism provided by the card-schemes and card issuing banks. Authorisations and Settlements of transactions are performed manually on the My Sage Pay Admin interface.</dd>

          <dt>Deferred</dt>
          <dd>The <em>Deferred</em> transaction method verifies and authorises the transaction and is captured manually on the Sage Pay Admin Interface.</dd>

          <dt>Payment</dt>
          <dd>The <em>Payment</em> transaction method verifies, authorises, and transfers the funds to your Merchant account via batch settlement.</dd>
        </dl>
      </td>
      <td><em>Authenticate</em></td>
    </tr>
    <tr>
      <td>Set Order Status</td>
      <td>The orders status will be updated to this value when a successful transaction has been made.</td>
      <td><em>Default Order Status</em></td>
    </tr>
    <tr>
      <td>Transaction Order Status</td>
      <td>Transactions are logged in this private order status level.</td>
      <td><em>Sage Pay [Transactions]</em></td>
    </tr>
    <tr>
      <td>Payment Zone</td>
      <td>If set, this payment method will only be available to orders made within the defined zone.</td>
      <td></td>
    </tr>
    <tr>
      <td>Transaction Server</td>
      <td>
        The following transaction servers are available to process transactions through:

        <dl>
          <dt>Live</dt>
          <dd>The <em>Live</em> server is used in production environments to process and receive payments from customers.</dd>

          <dt>Test</dt>
          <dd>The <em>Test</em> server is only used to test transactions on the Production server. No transactions are processed and no payments are made when transactions are being tested.</dd>
        </dl>
      </td>
      <td><em>Live</em></td>
    </tr>
    <tr>
      <td>Verify SSL Certificate</td>
      <td>Verify Sage Pay's identity when API communication calls are sent.</td>
      <td><em>True</em></td>
    </tr>
    <tr>
      <td>Proxy Server</td>
      <td>Send API communication calls through this proxy server.</td>
      <td></td>
    </tr>
    <tr>
      <td>Debug E-Mail Address</td>
      <td>Send invalid transaction parameters to this e-mail address.</td>
      <td></td>
    </tr>
    <tr>
      <td>Sort Order</td>
      <td>The position to show the payment method on the checkout payment page against other available payment methods.</td>
      <td></td>
    </tr>
    <tr>
      <td>Accept Visa</td>
      <td>Setting this parameter to <em>True</em> allows Visa payments to be accepted.</td>
      <td><em>True</em></td>
    </tr>
    <tr>
      <td>Accept Mastercard</td>
      <td>Setting this parameter to <em>True</em> allows Mastercard payments to be accepted.</td>
      <td><em>True</em></td>
    </tr>
    <tr>
      <td>Accept Mastercard Debit</td>
      <td>Setting this parameter to <em>True</em> allows Mastercard Debit payments to be accepted.</td>
      <td><em>True</em></td>
    </tr>
    <tr>
      <td>Accept Visa Delta/Debit</td>
      <td>Setting this parameter to <em>True</em> allows Visa Delta/Debit payments to be accepted</td>
      <td><em>True</em></td>
    </tr>
    <tr>
      <td>Accept Maestro</td>
      <td>Setting this parameter to <em>True</em> allows Maestro payments to be accepted.</td>
      <td><em>True</em></td>
    </tr>
    <tr>
      <td>Accept Visa Electron UK Debit</td>
      <td>Setting this parameter to <em>True</em> allows Visa Electron UK Debit payments to be accepted.</td>
      <td><em>True</em></td>
    </tr>
    <tr>
      <td>Accept American Express</td>
      <td>Setting this parameter to <em>True</em> allows American Express payments to be accepted</td>
      <td><em>True</em></td>
    </tr>
    <tr>
      <td>Accept Diners Club</td>
      <td>Setting this parameter to <em>True</em> allows Diners Club payments to be accepted.</td>
      <td><em>True</em></td>
    </tr>
    <tr>
      <td>Accept Japan Credit Bureau</td>
      <td>Setting this parameter to <em>True</em> allows Japan Credit Bureau payments to be accepted.</td>
      <td><em>True</em></td>
    </tr>
    <tr>
      <td>Accept Laser Card</td>
      <td>Setting this parameter to <em>True</em> allows Laser Card payments to be accepted.</td>
      <td><em>True</em></td>
    </tr>
    <tr>
      <td>Accept PayPal</td>
      <td>Setting this parameter to <em>True</em> allows PayPal payments to be accepted.</td>
      <td><em>False</em></td>
    </tr>
  </tbody>
</table>

<h2>Add-On Package</h2>

<p>The separate Sage Pay Direct Add-On package is available at:</p>

<p><a href="http://addons.oscommerce.com/info/6985" target="_blank">http://addons.oscommerce.com/info/6985</a></p>

<h2>Online Demonstration</h2>

<p>An online demonstration is available at:</p>

<p><a href="http://demo.oscommerce.com" target="_blank">http://demo.oscommerce.com</a></p>

<p><i>For the online demonstration, Sage Pay Direct has been configured with Sage Pay's test server environment and requires a test payment card to purchase an order.</i></p>

<h2>Manual Installation (as an Add-On)</h2>

<p>After extracting the Add-On package, copy the files located in the <em>catalog</em> directory to your osCommerce installation directory on the server. The files must be copied in the correct directory structure as extracted from the Add-On package.</p>

<p>The file listing is as follows:</p>

<ul>
  <li>ext/modules/content/account/sage_pay/cards.php</li>
  <li>ext/modules/payment/sage_pay/checkout.php</li>
  <li>ext/modules/payment/sage_pay/direct_3dauth.php</li>
  <li>ext/modules/payment/sage_pay/errors.php</li>
  <li>ext/modules/payment/sage_pay/redirect.php</li>
  <li>includes/languages/english/modules/content/account/cm_account_sage_pay_cards.php</li>
  <li>includes/languages/english/modules/payment/sage_pay_direct.php</li>
  <li>includes/modules/content/account/cm_account_sage_pay_cards.php</li>
  <li>includes/modules/payment/sage_pay_direct.php</li>
</ul>

<p>The standard language definitions in English are provided in the Add-On package. For additional languages, copy the English language definition file to the appropriate language directory and open the file with a text editor to edit the language definitions. The location of the language definition file must be in:</p>

<ul>
  <li>includes/languages/<em>LANGUAGE</em>/modules/content/account/cm_account_sage_pay_cards.php</li>
  <li>includes/languages/<em>LANGUAGE</em>/modules/payment/sage_pay_direct.php</li>
</ul>

<p>When the files have been copied to their appropriate locations, the payment module will be available on the Administration Tool -> Modules -> Payment -> Install Module page where it can be installed, or on the Administration Tool -> Modules -> Payment page if the module was already previously installed.</p>

<p>If the module was already previously installed, it is important to visit the module configuration page to make sure new parameters are automatically installed in the database.</p>

<h2>Changelog</h2>

<dl class="bulleted">
  <dt>v3.0 xx-May-2014</dt>
  <dd>Support PayPal payments.</dd>
  <dd>Introduce Sage Pay Cards Management Content Module for the My Account page (requires osCommerce Online Merchant v2.3.4).</dd>
  <dd>Autoselect payment module if customer has stored card tokens.</dd>

  <dt>v2.0 26-Jul-2013<dt>
  <dd>Support stored card tokens.</dd>
  <dd>Show month numbers instead of names for card expiry date.</dd>
  <dd>Dynamically show card start and issue number fields depending on card selected.</dd>
  <dd>Remove SOLO; Add LASER and MCDEBIT as allowed payment cards.</dd>
  <dd>Include transaction information in a private order status level.</dd>
  <dd>Add Test API Server Connection link in module configuration page.</dd>
  <dd>Verify SSL connections with public key certificate.</dd>

  <dt>v1.1 01-Sep-2009</dt>
  <dd>Fixed Live/Production Transaction Server parameter value to "Live".</dd>

  <dt>v1.0 28-Aug-2009</dt>
  <dd>Initial Release</dd>
</dl>
